---
title: API Reference

language_tabs: # must be one of https://github.com/rouge-ruby/rouge/wiki/List-of-supported-languages-and-lexers
  - python

toc_footers:
#  - <a href='#'>Sign Up for a Developer Key</a>
  - <a href='https://github.com/slatedocs/slate'>Documentation Powered by Slate</a>

includes:
  - errors

search: true

code_clipboard: true

meta:
  - name: description
    content: Documentation for the Kittn API
---

# Introduction

Welcome to PolypharmSolutions Mobile API Documentations. API is intended for use in PolypharmSolutions mobile application.
The API is a work in progress.

This API documentation page was created with [Slate](https://github.com/slatedocs/slate).

# Authentication

API uses user keys to enable authentication. Routes are only accessible by users (disabled for development).
Provide authorization header for each API request.

`Authorization: kg94385kgdsfj`

<aside class="notice">
You must replace <code>kg94385kgdsfj</code> with your personal API key.
</aside>

## Register

Takes a user model, saves it to database and sends a registration confirmation mail.

### HTTP Request

```python
response = requests.post('http://127.0.0.1:8000/auth/register', json=user)
```


`POST http://mobile-api.polypharm.solutions/auth/register`

### Request Body

Takes in a nested JSON with user and userDetails Objects 

> Example user

```json
{
  "user": {
    "email": "email@email.com",
    "password": "password123"
  },
  "userDetails": {
    "firstName": "Ivan",
    "lastName": "Horvat",
    "birthYear": 1978,
    "sex": "male",
    "height": 193,
    "weight": 105,
    "condition": ["Alcoholism", "Headache", "Hypertension"],
    "userDiscovery": "Doctor"
  }
}
```

### Body

{
  "user": user,
  "userDetails": userDetails
}

fields | type         | description
------ |--------------| -----------
"user" | user         | See below for description
"userDetails" | userDetails  | See below for description


### user

fields | type | description
------ | ---- | -----------
email | string | /
password | string | /

### userDetails

fields | type            | description
------ |-----------------| -----------
firstName | string          |
lastName | string          | /                                   
birthYear | integer         | year as integer                               
sex | "male" OR "female" | /                                             
height | integer         | in cm                                         
weight | integer         | in kg                                         
condition | [string, string] | list of strings                               
userDiscovery |  string         | where did user hear about us, simple dropdown

<aside class="warning">
List of available conditions is generated by calling the API for getting the conditions
</aside>

### Response
Code | Meaning
---------- | -------
200| Success -- Registration successful
403| Error -- User already exists




## Login

Produces an authorization token, used for accessing routes.

### HTTP Request

```python
response = requests.post('http://127.0.0.1:8000/auth/login', json=login_data)
```


`POST http://mobile-api.polypharm.solutions/auth/login`

### Body

> Example body

````json
{
   "email": "email@email.com",
   "password": "password123"`
}
````

fields | type | description
------ | ---- | -----------
email | string | /
password | string | /

### Returns

> The POST returns response body

````json
{
   "Authorization": "kg94385kgdsfj",
}
````

{"Authorization":  "kg94385kgdsfj"}

fields | type            | description
------ |-----------------| -----------
Authorization | string          | An authorization token used for verifying users


### Response

Code | Meaning
---------- | -------
200| Success -- Login successful
404| Error -- User not found
404| Error -- Password incorrect

# User
User related operations

## Me
Returns user profile

<aside class="notice">
Requires an authorization header.
</aside>

### HTTP Request

>Set Authorization headers

````json
{
  "Authorization": "kg94385kgdsfj"
}
````

>Example code

```python
headers = {'Authorization': "kg94385kgdsfj"}
response = requests.get('http://127.0.0.1:8000/user/me', headers=header)
```

`GET http://mobile-api.polypharm.solutions/user/me`

### Returns

> The POST returns response body

````json
{
  "userModel": {
    "createdOn": "2023-04-16T15:07:40.010492",
    "email": "example@mail.com",
    "id": 3,
    "passwordHash": "$6$rounds=656"},
  "userDetails": {
    "weight": 85,
    "firstName": "Ivan",
    "condition": ["Alcholism", "Something else"],
    "birthYear": 1952,
    "lastName": "Horvat",
    "userDiscovery": "Facebook",
    "id": 1,
    "height": 175,
   "sex": "male"
  }
}
````

{
  "userModel": userModel,
  "userDetails": userDetails
}

fields | type        | description
------ |-------------| -----------
"userModel" | userModel   | See below for description
"userDetails" | userDetails | See below for description


### userModel

fields | type | description
------ | ---- | -----------
email | string | /
passwordHash | string | /
id | integer | /
created_on | datetime |

### userDetails

fields | type            | description
------ |-----------------| -----------
firstName | string          |
lastName | string          | /                                   
birthYear | integer         | year as integer                               
sex | "male" OR "female" | /                                             
height | integer         | in cm                                         
weight | integer         | in kg                                         
condition | [string, string] | list of strings                               
userDiscovery |  string         | where did user hear about us, simple dropdown

### Response
Code | Meaning
---------- | -------
200| Success 
403| Error -- Invalid access token

## Update Condition
Changes user condition. For example if user gets over a condition or has a new one.
<aside class="notice">
Requires an authorization header.
</aside>
<aside class="warning">
List of available conditions is generated by calling the API for getting the conditions
</aside>

### HTTP Request

>Example code

```python
headers = {'Authorization': "kg94385kgdsfj"}
body = {'conditions': ['Headache', 'Stomach pain']}
response = requests.get('http://127.0.0.1:8000/user/conditions', headers=header, body=body)
```

`GET http://mobile-api.polypharm.solutions/user/me`

### Request Body

>Example body

````json
{
  "conditions": ["Headache", "Stomach Pain"]
}
````


{
  "conditions": ["Headache", "Stomach pain"]
}

fields | type                     | description
------ |--------------------------| -----------
"conditions" | [string, string, string] | List of strings

### Response
Code | Meaning
---------- | -------
200| Success -- Conditions updated successfully
400| Error -- Conditions field is required
403| Error -- Invalid access token

## Add Therapy

>Example code

```python
headers = {'Authorization': "kg94385kgdsfj"}
therapy = {
    "drugId": 1691,
    "productId": 2554,
    "dose": 800,
    "unit": 'mg',
    "quantity": 3,
    "frequency": 'daily',
    "duration": 10,
    "treats": 'Headache',
    "startDate": str(datetime.now()),
    "endDate": str(datetime.now()),
    "timeOfDay": str(time(14, 30)),
}
requests.post('http://127.0.0.1:8000/user/add_therapy', json=therapy, headers=headers).json()
```

Adds a medication to users therapy history.
<aside class="notice">
Requires an authorization header.
</aside>

### HTTP Request

`POST http://mobile-api.polypharm.solutions/user/add_therapy`

## Request Body

>Example body

````json
{
    "drugId": 1691,
    "productId": 2554,
    "dose": 800,
    "unit": "mg",
    "quantity": 3,
    "frequency": "daily",
    "duration": 10,
    "treats": "Headache",
    "startDate": "2023-04-16 23:41:11.683103",
    "endDate": "2023-04-16 23:41:11.683103",
    "timeOfDay": "14:30:00"
}   
````

{
    "drugId": int,
    "productId": int,
    "dose": float,
    "unit": string,
    "quantity": float,
    "frequency": string,
    "duration": int,
    "treats": string,
    "startDate": DateTime string,
    "endDate": DateTime string,
    "timeOfDay": Time string
}

fields | type            | description
------ |-----------------| -----------
"drugId" | int             | Ingredient ID
"productId" | int             | Product ID
"dose" | float           | How strong is the medicine, e.g. 30mg
"unit" | string          | How is it measured
"quantity" | int             | How many to take each time
"frequency" | string          | How often to take
"duration" | int             | How many days is the therapy
"treats" | string          | What is it for
"startDate" | DateTime string | /
"endDate" | DateTime string | /
"timeOfDay" | Time string     | When to take

### Response
Code | Meaning
---------- | -------
200| Success -- Therapy added successfully
403| Error -- Invalid access token

## Get Active Therapies
Get all active therapies
<aside class="notice">
Requires an authorization header.
</aside>

## Finish Therapy
Finishes a therapy as completed or discontinued or something like that.
<aside class="notice">
Requires an authorization header.
</aside>

## Add Appointment
Adds an appointment to appointment model.
<aside class="notice">
Requires an authorization header.
</aside>

## Get Active Appointments
Get all active appointments.
<aside class="notice">
Requires an authorization header.
</aside>

## Finish Appointment
Finishes an appointment as completed or missed.
<aside class="notice">
Requires an authorization header.
</aside>

# Polypharm
Functionalities that are related to personalized medicine selection and/or evaluation.

## Get Conditions
Returns a list of all conditions that a user can input.

### HTTP Request

>Example code

```python
response = requests.get('http://127.0.0.1:8000/polypharm/conditions')
```

`GET http://mobile-api.polypharm.solutions/polypharm/conditions`

### Returns

> GET returns response body

````json
[
  "Hyponatremia",
  "Hypocalcemica",
  "Xeroderma Pigmentosum"
]
````

[
  "Hyponatremia",
  "Hypocalcemica",
  "Xeroderma Pigmentosum",
  ...
]

### Response
Code | Meaning
---------- | -------
200| Success
400| Error -- PolypharmData API error




## Find drug
Searches a user input string to find a product or an active ingredient

### HTTP Request

>Example code

```python
response = requests.get('http://127.0.0.1:8000/polypharm/find_drug?string=iburpforen')
```

`GET http://mobile-api.polypharm.solutions/polypharm/find_drug`

### Query parameters

parameter | type   | description        
------ |--------| -------------------|
"string" | string | Whatever you're looking for

### Returns

> GET returns response body

````json
{
  "Ingredients": [
    {
      "id": 1691, 
      "name": "ibuprofen"
    }
  ],
 "Products": [
   {
     "brand_name": "Ibuprofen Belupo",
     "dose": 800.0,
     "id": 2554,
     "unit": "mg"
   },
  {
    "brand_name": "Dalsy", 
    "dose": 100.0, 
    "id": 2555, 
    "unit": "ml"
  },
  {
    "brand_name": "Ibuprofen Alkaloid",
    "dose": 100.0,
    "id": 2557,
    "unit": "ml"
  },
  {
    "brand_name": "Dalsy forte",
    "dose": 200.0, 
    "id": 2558, 
    "unit": "ml"
  },
  {
    "brand_name": "Ibuprofen JGL",
    "dose": 100.0, 
    "id": 2559, 
    "unit": "ml"
  }]
}
````

{
  "Ingredients": ingredient,
  "Products": product
}

fields | type       | description
------ |------------| -----------
"Ingredients" | ingredient | An active pharmaceutical ingredient
"Products" | product    | A branded pharmaceutical product


### ingredient

fields | type    | description
------ |---------| -----------
id | integer | Primary key of the product
name | string  | /

### product

fields | type    | description
------ |---------| -----------
brand_name | string  |
dose | float   | How strong it is, e.g. 30 mg                                   
id | integer | Primary key of the product
unit | string  | How is it measured, e.g. in mg


### Response
Code | Meaning
---------- | -------
200| Success
400| Error -- You must provide a valid query parameter string
400| Error -- PolypharmData API error


## Get ingredient
Returns an ingredient model from an ingredient ID

### HTTP Request

>Example code

```python
response = requests.get('http://127.0.0.1:8000/polypharm/ingredient/1691')
```

`GET http://mobile-api.polypharm.solutions/polypharm/ingredient/<id>`

### Route parameter

parameter | type | description        
------ |------| -------------------|
id | int  | ID of the ingredient

### Returns

> GET returns response body

````json
{
  "cyp1a2Inhibition": 0.06,
  "cyp2c19Inhibition": 0.05,
  "cyp2c9Inhibition": 0.2,
  "cyp2d6Inhibition": 0.0,
  "cyp3a4Inhibition": 0.0,
  "drugbankId": "DB01050",
  "id": 1691,
  "ingredient": "ibuprofen",
  "name": "ibuprofen",
  "prevents": ["Pain"],
  "treats": [
    "Arthritis, Juvenile",
    "Arthritis, Rheumatoid",
    "Bursitis",
    "Dysmenorrhea",
    "Fever",
    "Gout",
    "Inflammation",
    "Menorrhagia",
    "Osteoarthritis",
    "Pain, Postoperative",
    "Premenstrual Syndrome",
    "Spondylitis, Ankylosing"
  ]
}
````

{
  "cyp1a2Inhibition": float,
  "cyp2c19Inhibition": float,
  "cyp2c9Inhibition": float,
  "cyp2d6Inhibition": float,
  "cyp3a4Inhibition": float,
  "drugbankId": string,
  "id": int,
  "ingredient": string,
  "name": string,
  "prevents": [string],
  "treats": [string]
}

fields | type             | description
------ |------------------| -----------
"cyp1a2Inhibition" | float            | Inhibition of the CYP1A2 enzyme
"cyp2c19Inhibition" | float            | /
"cyp2c9Inhibition" | float            | /
"cyp2d6Inhibition" | float            | /
"cyp3a4Inhibition" | float            | /
"drugbankId" | string           | ID in the Drugbank database
"id" | string           | Primary key
"ingredient" | string           | /
"name" | string           | /
"prevents" | [string, string] | List of conditions (strings) which medicine can prevent
"treats" | [string, string] | List of conditions (strings) which medicine can treat

### Response
Code | Meaning
---------- | -------
200| Success
400| Error -- You must provide a product ID
400| Error -- PolypharmData API error

## Get product
Returns a product model from a product ID

### HTTP Request

>Example code

```python
response = requests.get('http://127.0.0.1:8000/polypharm/product/2554')
```

`GET http://mobile-api.polypharm.solutions/polypharm/product/<id>`

### Route parameter

parameter | type | description        
------ |------| -------------------|
id | int  | ID of the product

### Returns

> GET returns response body

````json
{
  "atc": "M01AE01",
  "brand_name": "Ibuprofen Belupo",
  "dose": 800.0,
  "drug_id": 1691,
  "indication": "NaN",
  "local_generic_name": "ibuprofen ",
  "manufacturer": "Belupo",
  "prescribing_level": "NaN",
  "quantity": 30.0,
  "route": "O",
  "unit": "mg"
}
````

{
  "atc": string,
  "brand_name": string,
  "dose": float,
  "drug_id": int,
  "indication": string,
  "local_generic_name": string,
  "manufacturer": string,
  "prescribing_level": string,
  "quantity": float,
  "route": string,
  "unit": string
}

fields | type   | description
------ |--------| -----------
atc | string | /
brand_name | string | /
dose | float  | How strong it is, e.g. 30mg
drug_id | int    | /
indication | string | /
local_generic_name | string | /
manufacturer | string | /
prescribing_level | string | Who can prescribe it
quantity | float  | How many are in a box of the product
route | string | How do you take it
unit | string | What is the unit, e.g. in mg

### Response
Code | Meaning
---------- | -------
200| Success
400| Error -- You must provide a product ID
400| Error -- PolypharmData API error

## Analyze regimen
Analyzes current user's regimen
<aside class="notice">
Requires an authorization header.
</aside>

## Scan drug
Evaluates how an addition of a new drug would influence patient's current regimen
<aside class="notice">
Requires an authorization header.
</aside>
